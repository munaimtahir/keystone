name: Bootstrap labels

on:
  workflow_dispatch:

permissions:
  issues: write

jobs:
  labels:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const labels = [
              { name: "bug", color: "d73a4a", description: "Something is broken" },
              { name: "enhancement", color: "a2eeef", description: "New feature or improvement" },
              { name: "task", color: "ededed", description: "Implementation task" },
              { name: "ops", color: "0e8a16", description: "Operations / infra" },
              { name: "deploy", color: "5319e7", description: "Deployment related" },

              { name: "severity:critical", color: "b60205", description: "System down / data loss" },
              { name: "severity:high", color: "d93f0b", description: "Major impact" },
              { name: "severity:medium", color: "fbca04", description: "Moderate impact" },
              { name: "severity:low", color: "0e8a16", description: "Minor issue" },

              { name: "area:frontend", color: "1d76db", description: "Frontend / UI" },
              { name: "area:backend", color: "0052cc", description: "Backend / API" },
              { name: "area:database", color: "006b75", description: "Database / migrations" },
              { name: "area:auth", color: "c2e0c6", description: "Auth / permissions" },
              { name: "area:deploy", color: "5319e7", description: "Docker / deployment" },
              { name: "area:ci", color: "bfd4f2", description: "CI/CD" },
              { name: "area:docs", color: "fef2c0", description: "Documentation" },
              { name: "area:other", color: "cccccc", description: "Other / uncategorized" }
            ];

            for (const label of labels) {
              try {
                await github.rest.issues.createLabel({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  ...label
                });
              } catch (e) {
                if (e.status !== 422) throw e; // ignore "already exists"
              }
            }
